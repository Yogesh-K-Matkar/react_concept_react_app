import{j as t,r as h}from"./index-BtnwLDn0.js";import{N as b,O as L,e as U,R as $,d as T}from"./dom-export-DoRVNdlq.js";import{a as I}from"./index-ngrFHoWO.js";import{Q as k,i as F,h as B,a as K,S as _,s as V,b as O,g as G,n as D,u as M,c as H,d as W,e as z,f as q,k as Z,j as J,l as X,R as Y}from"./index-C6BCXugw.js";const ee=""+new URL("react-query-Br724Q_Z.png",import.meta.url).href,te=()=>t.jsx("header",{children:t.jsxs("div",{children:[t.jsx(b,{to:"/",children:t.jsx("img",{className:"logo",src:ee,alt:"ReactQuery"})}),t.jsxs("ul",{children:[t.jsx("li",{children:t.jsx(b,{to:"/",children:"Home"})}),t.jsx("li",{children:t.jsx(b,{to:"/fetch/traditional",children:"TraditionalFetch"})}),t.jsx("li",{children:t.jsx(b,{to:"/fetch/reactquery",children:"ReactQueryFetch"})}),t.jsx("li",{children:t.jsx(b,{to:"/reactqueryinfinitescrolling",children:"ReactQueryInfiniteScrolling"})})]})]})}),se=()=>t.jsx("footer",{children:t.jsx("p",{children:"Â© 2025 ReactQuery. All rights reserved."})}),re=()=>t.jsxs(t.Fragment,{children:[t.jsx(te,{}),t.jsx("main",{children:t.jsx(L,{})}),t.jsx(se,{})]}),ne=()=>t.jsx(t.Fragment,{children:t.jsx("h1",{children:"Welcome to React Query API Calling"})}),oe="https://jsonplaceholder.typicode.com",ie="https://api.github.com",R=I.create({baseURL:oe,headers:{"Content-Type":"application/json"}}),ae=I.create({baseURL:ie,headers:{"Content-Type":"application/json"}}),A=async(e,r="/posts")=>{try{const s=await R.get(`${r}/?_page=${e}&_limit=3`);if(s.status===200)return s.data}catch(s){throw console.error("Error fetching post data",s),s}return[]},ce=async(e,r="/posts")=>{try{const s=await R.get(`${r}/${e}`);if(s.status===200)return s.data}catch(s){throw console.error("Error fetching post data",s),s}return[]},ue=async(e,r="/posts")=>{try{const s=await R.post(r,e);if(s.status===201)return s}catch(s){throw console.error("Error adding post data",s),new Error(s)}},le=async(e,r="/posts")=>{try{const s=await R.delete(`${r}/${e}`);if(s.status===200)return s}catch(s){throw console.error("Error deleting post data",s),new Error(s)}return[]},de=async(e,r,s="/posts")=>{try{const o=await R.patch(`${s}/${e}`,r);if(o.status===200)return o}catch(o){throw console.error("Error updating post data",o),new Error(o)}return[]},he=async({pageParam:e=1},r="/users")=>{try{const s=await ae.get(`${r}?per_page=10&page=${e}`);if(s.status===200)return s.data}catch(s){throw console.error("Error infinite fetching users data",s),s}return[]},fe=()=>{const[e,r]=h.useState([]),[s,o]=h.useState(!0),[u,d]=h.useState(!1),a=h.useCallback(async()=>{try{const i=await A();r(i),o(!1)}catch(i){console.error("Error fetching data:",i),o(!1),d(!0)}},[e]);return h.useEffect(()=>{a(),e&&o(!1)},[]),console.log("API Data:",e),s?t.jsx("div",{className:"loader",children:"Loading..."}):u?t.jsx("div",{children:"Error fetching data"}):t.jsxs(t.Fragment,{children:[t.jsx("h1",{children:"Traditional Fetch Data"}),t.jsx("div",{className:"section-accordion",children:t.jsx("ol",{children:e?.map(i=>{const{id:c,title:f,body:g}=i;return t.jsxs("li",{children:[c,". ",f,t.jsx("br",{}),t.jsx("br",{}),g]},c)})})})]})};var ge=class extends k{constructor(e,r){super(e,r)}bindMethods(){super.bindMethods(),this.fetchNextPage=this.fetchNextPage.bind(this),this.fetchPreviousPage=this.fetchPreviousPage.bind(this)}setOptions(e){super.setOptions({...e,behavior:F()})}getOptimisticResult(e){return e.behavior=F(),super.getOptimisticResult(e)}fetchNextPage(e){return this.fetch({...e,meta:{fetchMore:{direction:"forward"}}})}fetchPreviousPage(e){return this.fetch({...e,meta:{fetchMore:{direction:"backward"}}})}createResult(e,r){const{state:s}=e,o=super.createResult(e,r),{isFetching:u,isRefetching:d,isError:a,isRefetchError:i}=o,c=s.fetchMeta?.fetchMore?.direction,f=a&&c==="forward",g=u&&c==="forward",v=a&&c==="backward",P=u&&c==="backward";return{...o,fetchNextPage:this.fetchNextPage,fetchPreviousPage:this.fetchPreviousPage,hasNextPage:K(r,s.data),hasPreviousPage:B(r,s.data),isFetchNextPageError:f,isFetchingNextPage:g,isFetchPreviousPageError:v,isFetchingPreviousPage:P,isRefetchError:i&&!f&&!v,isRefetching:d&&!g&&!P}}},pe=class extends _{#s;#r=void 0;#e;#t;constructor(e,r){super(),this.#s=e,this.setOptions(r),this.bindMethods(),this.#n()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){const r=this.options;this.options=this.#s.defaultMutationOptions(e),V(this.options,r)||this.#s.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#e,observer:this}),r?.mutationKey&&this.options.mutationKey&&O(r.mutationKey)!==O(this.options.mutationKey)?this.reset():this.#e?.state.status==="pending"&&this.#e.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#e?.removeObserver(this)}onMutationUpdate(e){this.#n(),this.#o(e)}getCurrentResult(){return this.#r}reset(){this.#e?.removeObserver(this),this.#e=void 0,this.#n(),this.#o()}mutate(e,r){return this.#t=r,this.#e?.removeObserver(this),this.#e=this.#s.getMutationCache().build(this.#s,this.options),this.#e.addObserver(this),this.#e.execute(e)}#n(){const e=this.#e?.state??G();this.#r={...e,isPending:e.status==="pending",isSuccess:e.status==="success",isError:e.status==="error",isIdle:e.status==="idle",mutate:this.mutate,reset:this.reset}}#o(e){D.batch(()=>{if(this.#t&&this.hasListeners()){const r=this.#r.variables,s=this.#r.context;e?.type==="success"?(this.#t.onSuccess?.(e.data,r,s),this.#t.onSettled?.(e.data,null,r,s)):e?.type==="error"&&(this.#t.onError?.(e.error,r,s),this.#t.onSettled?.(void 0,e.error,r,s))}this.listeners.forEach(r=>{r(this.#r)})})}};function N(e,r){const s=M(),[o]=h.useState(()=>new pe(s,e));h.useEffect(()=>{o.setOptions(e)},[o,e]);const u=h.useSyncExternalStore(h.useCallback(a=>o.subscribe(D.batchCalls(a)),[o]),()=>o.getCurrentResult(),()=>o.getCurrentResult()),d=h.useCallback((a,i)=>{o.mutate(a,i).catch(H)},[o]);if(u.error&&W(o.options.throwOnError,[u.error]))throw u.error;return{...u,mutate:d,mutateAsync:u.mutate}}function xe(e,r){return z(e,ge)}const ye=()=>{const[e,r]=h.useState(1),{data:s,isPending:o,isError:u,error:d}=q({queryKey:["posts",e],queryFn:async()=>await A(e),gcTime:2*1e3,staleTime:5*1e3,placeholderData:Z});console.log("API Data:",s);const a=M(),i=()=>c.mutate(),c=N({mutationFn:async()=>await ue({title:"I have added a new post",body:"Added"}),onSuccess:async n=>{console.log(n);const{data:l,status:x}=n;if(x===201){const{id:p,title:m,body:y}=l;return await a.setQueryData(["posts",e],j=>[...j,{userId:p,id:p,title:m,body:y}])}console.log(x===201&&"Post added successfully")},onError:n=>console.error(n),onSettled:(n,l)=>console.log(n,l)}),f=n=>g.mutate(n),g=N({mutationFn:async n=>await de(n,{title:"I have updated the post",body:"Updated"}),onSuccess:async(n,l)=>{console.log(n,l);const{data:x,status:p}=n;if(p===200){const{title:m,body:y}=x;return await a.setQueryData(["posts",e],j=>j?.map(w=>w.id===l?{...w,title:m,body:y}:w))}console.log(p===200&&"Post updated successfully")},onError:n=>console.error(n),onSettled:(n,l)=>console.log(n,l)}),v=n=>P.mutate(n),P=N({mutationFn:async n=>await le(n),onSuccess:async(n,l)=>{console.log(n,l);const{status:x}=n;if(x===200)return await a.setQueryData(["posts",e],p=>p?.filter(m=>m.id!==l));console.log(x===200&&"Post deleted successfully")},onError:n=>console.error(n),onSettled:(n,l)=>console.log(n,l)});return o?t.jsx("div",{className:"loader",children:"Loading..."}):u?t.jsx("div",{children:console.error(d.message||"Error fetching data!")}):t.jsxs(t.Fragment,{children:[t.jsx("h1",{children:"ReactQuery Fetch Data"}),t.jsxs("div",{className:"section-accordion",children:[t.jsx("ol",{children:s?.map(n=>{let{id:l,title:x,body:p}=n;return t.jsxs("li",{children:[l,". ",t.jsx(b,{to:`/fetch/reactquery/${l}`,children:x}),t.jsx("br",{}),t.jsx("br",{}),p,t.jsx("br",{}),t.jsx("br",{}),t.jsx("button",{onClick:()=>f(l),children:"Update"}),t.jsx("button",{onClick:()=>v(l),children:"Delete"}),t.jsx("br",{})]},l)})}),t.jsx("button",{onClick:()=>i(),children:"Add New Post"}),t.jsx("br",{})]}),t.jsxs("div",{className:"pagination-section container",children:[t.jsx("button",{onClick:()=>r(n=>n-1),disabled:e===1,children:"Prev"}),t.jsx("h2",{children:e}),t.jsx("button",{onClick:()=>r(n=>n+1),children:"Next"})]})]})},je=()=>{const e=U(),{id:r}=e,{data:s,isPending:o,isError:u,error:d}=q({queryKey:["post",r],queryFn:async()=>await ce(r)});if(console.log("API Data:",s),o)return t.jsx("div",{className:"loader",children:"Loading..."});if(u)return t.jsx("div",{children:console.error(d.message||"Error fetching data!")});const{title:a,body:i}=s;return t.jsxs(t.Fragment,{children:[t.jsx("h1",{children:"ReactQuery Fetch Data Details"}),t.jsxs("div",{className:"section-accordion",children:[t.jsxs("h1",{children:["Post ID:- ",r]}),t.jsxs("div",{children:[t.jsxs("p",{children:["Title: ",a]}),t.jsxs("p",{children:["Body: ",i]})]}),t.jsx(b,{to:"/fetch/reactquery",children:t.jsx("button",{children:"Go Back"})})]})]})};var Q=new Map,E=new WeakMap,C=0,ve=void 0;function me(e){return e?(E.has(e)||(C+=1,E.set(e,C.toString())),E.get(e)):"0"}function be(e){return Object.keys(e).sort().filter(r=>e[r]!==void 0).map(r=>`${r}_${r==="root"?me(e.root):e[r]}`).toString()}function Pe(e){const r=be(e);let s=Q.get(r);if(!s){const o=new Map;let u;const d=new IntersectionObserver(a=>{a.forEach(i=>{var c;const f=i.isIntersecting&&u.some(g=>i.intersectionRatio>=g);e.trackVisibility&&typeof i.isVisible>"u"&&(i.isVisible=f),(c=o.get(i.target))==null||c.forEach(g=>{g(f,i)})})},e);u=d.thresholds||(Array.isArray(e.threshold)?e.threshold:[e.threshold||0]),s={id:r,observer:d,elements:o},Q.set(r,s)}return s}function we(e,r,s={},o=ve){if(typeof window.IntersectionObserver>"u"&&o!==void 0){const c=e.getBoundingClientRect();return r(o,{isIntersecting:o,target:e,intersectionRatio:typeof s.threshold=="number"?s.threshold:0,time:0,boundingClientRect:c,intersectionRect:c,rootBounds:c}),()=>{}}const{id:u,observer:d,elements:a}=Pe(s),i=a.get(e)||[];return a.has(e)||a.set(e,i),i.push(r),d.observe(e),function(){i.splice(i.indexOf(r),1),i.length===0&&(a.delete(e),d.unobserve(e)),a.size===0&&(d.disconnect(),Q.delete(u))}}function Re({threshold:e,delay:r,trackVisibility:s,rootMargin:o,root:u,triggerOnce:d,skip:a,initialInView:i,fallbackInView:c,onChange:f}={}){var g;const[v,P]=h.useState(null),n=h.useRef(f),[l,x]=h.useState({inView:!!i,entry:void 0});n.current=f,h.useEffect(()=>{if(a||!v)return;let j;return j=we(v,(w,S)=>{x({inView:w,entry:S}),n.current&&n.current(w,S),S.isIntersecting&&d&&j&&(j(),j=void 0)},{root:u,rootMargin:o,threshold:e,trackVisibility:s,delay:r},c),()=>{j&&j()}},[Array.isArray(e)?e.toString():e,v,u,o,d,a,s,c,r]);const p=(g=l.entry)==null?void 0:g.target,m=h.useRef(void 0);!v&&p&&!d&&!a&&m.current!==p&&(m.current=p,x({inView:!!i,entry:void 0}));const y=[P,l.inView,l.entry];return y.ref=y[0],y.inView=y[1],y.entry=y[2],y}const Ee=()=>{const{data:e,status:r,hasNextPage:s,fetchNextPage:o,isFetchingNextPage:u}=xe({queryKey:["users"],queryFn:he,getNextPageParam:(i,c)=>(console.log("lastPage",i,c),i.length===10?c.length+1:void 0),initialPageParam:1});console.log(e);const{ref:d,inView:a}=Re({threshold:1});return h.useEffect(()=>{a&&s&&o()},[s,o,a]),r==="loading"?t.jsx("div",{className:"loader",children:"Loading..."}):r==="error"?t.jsx("div",{children:console.error("Error fetching data!")}):t.jsxs(t.Fragment,{children:[t.jsx("h1",{children:"Infinite Scrolling using React Quey v5"}),e?.pages?.map((i,c)=>t.jsx("ul",{children:i?.map((f,g)=>t.jsxs("li",{style:{padding:"10px",border:"1px solid #ccc"},children:[t.jsx("p",{children:f.login}),t.jsx("img",{src:f.avatar_url,alt:f.login,width:50,height:50})]},g))},c)),t.jsx("div",{ref:d,style:{padding:"20px",textAlign:"center"},children:t.jsx("div",{className:"loader",children:u?"Loading more...":s?"Scroll down to load more":"Nothing more to load "})})]})},Se=T([{path:"/",element:t.jsx(re,{}),children:[{path:"/",element:t.jsx(ne,{})},{path:"/fetch/traditional",element:t.jsx(fe,{})},{path:"/fetch/reactquery",element:t.jsx(ye,{})},{path:"/fetch/reactquery/:id",element:t.jsx(je,{})},{path:"/reactqueryinfinitescrolling",element:t.jsx(Ee,{})}]}]),Ce=()=>{const e=new J;return t.jsxs(X,{client:e,children:[t.jsx($,{router:Se}),t.jsx(Y,{initialIsOpen:!0})]})};export{Ce as default};
